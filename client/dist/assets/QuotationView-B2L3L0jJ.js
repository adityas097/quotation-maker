import{c as u,A as y,j as e}from"./index-C5bGCW4r.js";import{f as k,b as a,L as B}from"./vendor-hBbQJCfh.js";import{a as f}from"./authFetch-CQWmCeCA.js";import{A as R}from"./arrow-left-DP78AEqu.js";const P=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],W=u("file-check",P);const F=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],O=u("printer",F),Q=()=>{const{id:c}=k(),[i,b]=a.useState(null),[n,v]=a.useState(null),[T,A]=a.useState(!0);a.useEffect(()=>{g()},[c]);const g=async()=>{try{const s=await(await f(`${y}/api/quotations/${c}`)).json();if(b(s),s.company_snapshot)try{v(typeof s.company_snapshot=="string"?JSON.parse(s.company_snapshot):s.company_snapshot)}catch(r){console.error(r)}}catch(t){console.error(t)}finally{A(!1)}},N=async()=>{if(window.confirm("Convert this quotation to an invoice?"))try{const t=await f(`${y}/api/invoices/convert/${c}`,{method:"POST"});if(t.ok)alert("Invoice created successfully!"),g();else{const s=await t.json();alert("Error: "+s.error)}}catch(t){console.error(t)}},S=()=>{if(!i)return{subtotal:0,tax:0,total:0};let t=0,s=0,r={};i.items.forEach(p=>{const _=p.quantity||0,C=p.rate||0,o=_*C,l=p.tax_rate||0,h=r[l]||{taxable:0,tax:0};h.taxable+=o,h.tax+=o*(l/100),r[l]=h,t+=o,s+=o*(l/100)});let d=0;i.discount_type==="PERCENT"?d=t*(i.discount_value/100):d=i.discount_value||0;const z=t+s-d;return{subtotal:t,totalTax:s,discountAmount:d,grandTotal:z,taxBreakdown:r}},w=t=>`Rupees ${Math.round(t)} Only`;if(T||!i)return e.jsx("div",{className:"p-8 text-center",children:"Loading..."});const{subtotal:E,totalTax:I,discountAmount:m,grandTotal:j,taxBreakdown:M}=S(),x=i.status==="INVOICED"||i.status==="PAID";return e.jsxs("div",{className:"max-w-4xl mx-auto print-container",style:{padding:"20px"},children:[e.jsxs("div",{className:"flex-between mb-6 no-print",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{to:"/quotations",className:"btn btn-secondary",children:[e.jsx(R,{size:16})," Back"]}),!x&&e.jsxs("button",{onClick:N,className:"btn btn-success",children:[e.jsx(W,{size:16})," Convert to Invoice"]})]}),e.jsxs("button",{onClick:()=>window.print(),className:"btn btn-primary",children:[e.jsx(O,{size:16})," Print / Save PDF"]})]}),e.jsxs("div",{className:"card quote-paper",style:{minHeight:"80vh",border:"1px solid #ddd",padding:"40px",position:"relative",marginBottom:"100px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"2px solid var(--primary-color)",paddingBottom:"20px",marginBottom:"20px"},children:[e.jsx("div",{children:n?e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"2rem",fontWeight:800,color:"#0f172a",margin:0},children:n.name}),e.jsx("p",{style:{margin:"5px 0",fontSize:"1rem",fontWeight:500},children:n.address}),e.jsxs("div",{style:{display:"flex",gap:"15px",fontSize:"0.9rem",marginTop:"5px"},children:[n.gstin&&e.jsxs("span",{children:[e.jsx("strong",{children:"GSTIN:"})," ",n.gstin]}),n.pan&&e.jsxs("span",{children:[e.jsx("strong",{children:"PAN:"})," ",n.pan]})]}),e.jsxs("p",{style:{margin:"10px 0 0 0",fontSize:"0.9rem"},children:[n.phone&&e.jsxs("span",{style:{marginRight:"15px"},children:["ðŸ“ž ",n.phone]}),n.email&&e.jsxs("span",{children:["ðŸ“§ ",n.email]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"2rem",fontWeight:800,color:"#0f172a",margin:0},children:"ELIZA INFOTECH"}),e.jsx("p",{style:{margin:"5px 0",fontSize:"1rem",fontWeight:500},children:"29/20, 8 MARLA, PANIPAT - 132103"}),e.jsxs("p",{style:{margin:"0",fontSize:"0.9rem"},children:[e.jsx("strong",{children:"GSTIN:"})," 06HHQPS1919L1ZJ"]}),e.jsxs("p",{style:{margin:"5px 0 0 0",fontSize:"0.9rem"},children:[e.jsx("span",{style:{marginRight:"15px"},children:"ðŸ“ž +91 893082398"}),e.jsx("span",{style:{marginRight:"15px"},children:"ðŸŒ elizainfotech.com"}),e.jsx("br",{}),e.jsx("span",{children:"ðŸ“§ infotecheliza@gmail.com"})]})]})}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",color:"#555",marginTop:"0"},children:x?"TAX INVOICE":"QUOTATION"}),e.jsx("table",{style:{float:"right",fontSize:"0.9rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"right",paddingRight:"10px",color:"#666"},children:"# :"}),e.jsx("td",{style:{fontWeight:600},children:x?i.invoice_number:`QT-${i.id}`})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"right",paddingRight:"10px",color:"#666"},children:"Date :"}),e.jsx("td",{style:{fontWeight:600},children:i.date})]})]})})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{fontSize:"0.85rem",textTransform:"uppercase",color:"#888",marginBottom:"5px"},children:"Bill To:"}),e.jsx("p",{style:{fontSize:"1.2rem",fontWeight:700,margin:"0 0 5px 0"},children:i.client_name}),i.client_address&&e.jsx("p",{style:{margin:"0",fontSize:"0.95rem",maxWidth:"300px"},children:i.client_address}),i.client_gstin&&e.jsxs("p",{style:{margin:"5px 0 0 0",fontSize:"0.9rem"},children:[e.jsx("strong",{children:"GSTIN:"})," ",i.client_gstin]})]}),e.jsx("div",{className:"table-container",style:{marginBottom:"20px"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f5f5f5",borderBottom:"2px solid #ddd"},children:[e.jsx("th",{style:{textAlign:"left",padding:"10px"},children:"#"}),e.jsx("th",{style:{textAlign:"left",padding:"10px"},children:"Description"}),e.jsx("th",{style:{textAlign:"left",padding:"10px"},children:"HSN"}),e.jsx("th",{style:{textAlign:"right",padding:"10px"},children:"Qty"}),e.jsx("th",{style:{textAlign:"right",padding:"10px"},children:"Rate"}),e.jsx("th",{style:{textAlign:"right",padding:"10px"},children:"Tax"}),e.jsx("th",{style:{textAlign:"right",padding:"10px"},children:"Total"})]})}),e.jsx("tbody",{children:i.items.map((t,s)=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[e.jsx("td",{style:{padding:"10px"},children:s+1}),e.jsxs("td",{style:{padding:"10px"},children:[e.jsx("div",{style:{fontWeight:600},children:t.name}),t.model_number&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"#666"},children:["Model: ",t.model_number]}),t.description&&e.jsx("div",{style:{fontSize:"0.85rem",color:"#555"},children:t.description})]}),e.jsx("td",{style:{padding:"10px"},children:t.hsn_code}),e.jsx("td",{style:{textAlign:"right",padding:"10px"},children:t.quantity}),e.jsxs("td",{style:{textAlign:"right",padding:"10px"},children:["â‚¹",t.rate.toFixed(2)]}),e.jsxs("td",{style:{textAlign:"right",padding:"10px"},children:[t.tax_rate,"%"]}),e.jsxs("td",{style:{textAlign:"right",padding:"10px",fontWeight:600},children:["â‚¹",(t.quantity*t.rate).toFixed(2)]})]},t.id))})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px",gap:"30px",flexWrap:"wrap",pageBreakInside:"avoid"},children:[e.jsxs("div",{style:{flex:1,minWidth:"300px"},children:[e.jsxs("div",{style:{border:"1px solid #eee",padding:"10px",borderRadius:"4px",marginBottom:"15px",backgroundColor:"#f9fafb"},children:[e.jsx("h4",{style:{margin:"0 0 5px 0",fontSize:"0.8rem",fontWeight:700,borderBottom:"1px solid #ddd",paddingBottom:"2px"},children:"Bank Details"}),e.jsx("table",{style:{fontSize:"0.75rem",width:"100%",lineHeight:"1.4"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",width:"70px",padding:"1px"},children:"Bank:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:n?n.bank_name:"Central Bank of India"})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",padding:"1px"},children:"A/C Name:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:n?n.account_holder_name||n.name:"Eliza Infotech"})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",padding:"1px"},children:"A/C No:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:n?n.account_no:"5213284825"})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",padding:"1px"},children:"IFSC:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:n?n.ifsc:"CBIN0283246"})})]}),n&&n.upi_id&&e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",padding:"1px"},children:"UPI:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:n.upi_id})})]}),!n&&e.jsxs("tr",{children:[e.jsx("td",{style:{color:"#666",padding:"1px"},children:"UPI:"}),e.jsx("td",{style:{padding:"1px"},children:e.jsx("strong",{children:"8930082398"})})]})]})})]}),i.notes&&e.jsxs("div",{style:{marginBottom:"15px",fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Notes:"}),e.jsx("p",{style:{margin:"5px 0",whiteSpace:"pre-line",color:"#444"},children:i.notes})]}),i.terms&&e.jsxs("div",{style:{marginBottom:"15px",fontSize:"0.8rem"},children:[e.jsx("strong",{children:"Terms & Conditions:"}),e.jsx("p",{style:{margin:"5px 0",whiteSpace:"pre-line",color:"#444"},children:i.terms})]})]}),e.jsxs("div",{style:{width:"300px"},children:[e.jsxs("div",{className:"flex-between",style:{padding:"5px 0"},children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["â‚¹",E.toFixed(2)]})]}),e.jsxs("div",{className:"flex-between",style:{padding:"5px 0"},children:[e.jsx("span",{children:"Total Tax:"}),e.jsxs("span",{children:["â‚¹",I.toFixed(2)]})]}),m>0&&e.jsxs("div",{className:"flex-between",style:{padding:"5px 0",color:"red"},children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["- â‚¹",m.toFixed(2)]})]}),e.jsxs("div",{className:"flex-between",style:{padding:"10px 0",borderTop:"2px solid #ddd",fontSize:"1.2rem",fontWeight:800},children:[e.jsx("span",{children:"Grand Total:"}),e.jsxs("span",{children:["â‚¹",j.toFixed(0)]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px",textAlign:"right"},children:["Amount (in words):",e.jsx("br",{})," ",w(j)]})]})]})]}),e.jsxs("div",{className:"print-footer",style:{marginTop:"auto",padding:"10px",textAlign:"center",fontSize:"0.75rem",color:"#666",borderTop:"1px solid #eee",background:"white"},children:[e.jsx("p",{style:{fontWeight:700,margin:"0 0 5px 0"},children:"CONTACT FOR:"}),e.jsxs("p",{style:{margin:0,lineHeight:"1.4"},children:["CCTV CAMERAS â€¢ INTERNET NETWORKING EQUIPMENT â€¢ FTTH AND RADIO FREQUENCY NETWORKING DEVICES",e.jsx("br",{}),"INTERNET MARKETING â€¢ WEB & APP DEVELOPMENT â€¢ SOCIAL MEDIA MANAGEMENT â€¢ SEO AND MORE"]})]}),e.jsx("style",{children:`
        @media print {
          .no-print { display: none !important; }
          .app-container { min-height: auto; width: 100%; margin: 0; padding: 0; }
          .navbar { display: none; }
          .card { box-shadow: none; border: none !important; padding: 0 !important; margin: 0 !important; }
          body { background: white; margin: 0; padding: 0; }
          .print-container { max-width: 100% !important; margin: 0 !important; width: 100%; }
          
          /* Footer Fix */
          .print-footer {
             position: fixed;
             bottom: 0;
             left: 0;
             right: 0;
             height: 50px; /* Approx height of footer content */
             background: white;
          }
          
          /* Page Margin to prevent overlap with fixed footer */
          @page {
             margin: 10mm;
             margin-bottom: 25mm; /* 1 inch approx for footer space */
          }
        }
      `})]})};export{Q as default};
