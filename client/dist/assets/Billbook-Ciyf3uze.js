import{A as o,j as e,F as b}from"./index-C5bGCW4r.js";import{b as i}from"./vendor-hBbQJCfh.js";import{u as w,P}from"./PaginationControls-7gw_ikq3.js";import{a as r}from"./authFetch-CQWmCeCA.js";import{S as I}from"./square-pen-CUClBDmr.js";import{C as A}from"./copy-CovPg2zi.js";const $=()=>{const[c,l]=i.useState([]),[d,n]=i.useState(!1),{currentPage:h,totalPages:x,pageSize:j,totalItems:u,currentItems:a,goToPage:m,changePageSize:g}=w(c);i.useEffect(()=>{f()},[]);const f=async()=>{try{n(!0);const t=await r(`${o}/api/invoices`);if(!t.ok)throw new Error("Failed to fetch invoices");const s=await t.json();l(Array.isArray(s)?s:[])}catch(t){console.error(t)}finally{n(!1)}},p=async t=>{if(window.confirm("Create a new Draft Quote from this Invoice?"))try{const s=await r(`${o}/api/quotations/duplicate/${t}`,{method:"POST"});if(s.ok){const y=await s.json();window.location.href=`/quotations/${y.id}/edit`}}catch(s){console.error(s)}};return e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"mb-6",children:"Billbook (Invoices)"}),e.jsx("div",{className:"table-container",children:d?e.jsx("p",{children:"Loading invoices..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice #"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[a.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:t.invoice_number}),e.jsx("td",{children:t.date}),e.jsx("td",{children:t.client_name}),e.jsxs("td",{style:{fontWeight:600},children:["â‚¹",t.total_amount?.toFixed(2)]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.status==="PAID"?"badge-success":"badge-warning"}`,children:t.status})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx("a",{href:`/quotations/${t.quotation_id}`,className:"btn btn-secondary p-2",title:"View Quote/Invoice",children:e.jsx(b,{size:16})}),e.jsx("a",{href:`/quotations/${t.quotation_id}/edit`,className:"btn btn-secondary p-2",title:"Edit",children:e.jsx(I,{size:16})}),e.jsx("button",{className:"btn btn-secondary p-2",onClick:()=>p(t.quotation_id),title:"Duplicate to New Draft",children:e.jsx(A,{size:16})})]})})]},t.id)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",style:{textAlign:"center",padding:"2rem"},children:"No invoices found. Convert a quote to an invoice to see it here."})})]})]}),e.jsx(P,{currentPage:h,totalPages:x,pageSize:j,totalItems:u,onPageChange:m,onPageSizeChange:g})]})})]})};export{$ as default};
