import{c,u as N,A as p,j as e,a as g,U as w}from"./index-C5bGCW4r.js";import{b as n}from"./vendor-hBbQJCfh.js";import{a as y}from"./authFetch-CQWmCeCA.js";import{L as h}from"./lock-CE-fPV5n.js";const k=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],_=c("briefcase",k);const P=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],S=c("circle-alert",P);const C=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],U=c("dollar-sign",C);const A=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],L=c("save",A),R=()=>{const{user:M}=N(),[s,d]=n.useState({username:"",business_category:"",turnover:"",employee_count:"",password:"",confirmPassword:""}),[b,f]=n.useState(!0),[x,u]=n.useState(!1),[l,a]=n.useState({type:"",text:""});n.useEffect(()=>{v()},[]);const v=async()=>{try{const r=await y(`${p}/api/users/profile`);if(r.ok){const t=await r.json();d(i=>({...i,username:t.username,business_category:t.business_category||"",turnover:t.turnover||"",employee_count:t.employee_count||""}))}}catch(r){console.error(r)}finally{f(!1)}},o=r=>{d({...s,[r.target.name]:r.target.value})},j=async r=>{if(r.preventDefault(),a({type:"",text:""}),s.password&&s.password!==s.confirmPassword)return a({type:"error",text:"Passwords do not match"});u(!0);try{const t={business_category:s.business_category,turnover:s.turnover,employee_count:s.employee_count};s.password&&(t.password=s.password);const i=await y(`${p}/api/users/profile`,{method:"PUT",body:JSON.stringify(t)});if(i.ok)a({type:"success",text:"Profile updated successfully"}),d(m=>({...m,password:"",confirmPassword:""}));else{const m=await i.json();a({type:"error",text:m.error||"Failed to update profile"})}}catch{a({type:"error",text:"An error occurred"})}finally{u(!1)}};return b?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading profile..."}):e.jsxs("div",{className:"max-w-4xl mx-auto pb-12",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[e.jsx(g,{className:"text-indigo-600"})," My Profile"]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6 md:p-8",children:[l.text&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center gap-2 ${l.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[l.type==="error"&&e.jsx(S,{size:18}),l.text]}),e.jsxs("form",{onSubmit:j,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 border-b border-gray-100 pb-2",children:"Account Information"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username / Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(g,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:s.username,disabled:!0,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Username/Email cannot be changed."})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 border-b border-gray-100 pb-2",children:"Change Password"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(h,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:o,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Leave blank to keep current"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(h,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"password",name:"confirmPassword",value:s.confirmPassword,onChange:o,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"Repeat new password"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 border-b border-gray-100 pb-2",children:"Business Details"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Category"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"business_category",value:s.business_category,onChange:o,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"e.g. Retail, Manufacturing, Services"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Turnover"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(U,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"turnover",value:s.turnover,onChange:o,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"e.g. 50 Lakhs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Employees"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(w,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",name:"employee_count",value:s.employee_count,onChange:o,className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",placeholder:"e.g. 1-10"})]})]})]})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:x,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2.5 rounded-lg font-medium shadow-sm transition-colors flex items-center gap-2",children:[e.jsx(L,{size:18}),x?"Saving...":"Save Changes"]})})]})]})})]})};export{R as default};
