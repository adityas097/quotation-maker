import{c as p,A as c,j as e}from"./index-C5bGCW4r.js";import{b as n}from"./vendor-hBbQJCfh.js";import{a as d}from"./authFetch-CQWmCeCA.js";import{M as w}from"./Modal-Ba9AK1t8.js";import{P as C}from"./plus-BroQ0DqQ.js";import{T as N}from"./trash-2-BCfEatWq.js";const k=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],A=p("shield-off",k);const S=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],U=p("shield",S),P=()=>{const[h,x]=n.useState([]),[j,u]=n.useState(!1),[y,l]=n.useState(!1),[r,i]=n.useState({username:"",password:"",role:"user"});n.useEffect(()=>{o()},[]);const o=async()=>{try{u(!0);const s=await d(`${c}/api/users`);if(s.ok){const t=await s.json();x(t)}else console.error("Failed to fetch users")}catch(s){console.error(s)}finally{u(!1)}},b=async s=>{s.preventDefault();try{const t=await d(`${c}/api/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(t.ok)l(!1),i({username:"",password:"",role:"user"}),o();else{const a=await t.json();alert(a.error||"Failed to create user")}}catch(t){console.error(t),alert("Error creating user")}},f=async s=>{const t=s.status==="active"?"disabled":"active";if(window.confirm(`Are you sure you want to ${t==="active"?"enable":"disable"} ${s.username}?`))try{const a=await d(`${c}/api/users/${s.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(a.ok)o();else{const v=await a.json();alert(v.error)}}catch(a){console.error(a)}},g=async s=>{if(window.confirm("Permanently delete this user?"))try{const t=await d(`${c}/api/users/${s}`,{method:"DELETE"});if(t.ok)o();else{const a=await t.json();alert(a.error)}}catch(t){console.error(t)}};return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex-between mb-6",children:[e.jsx("h2",{children:"User Management"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>l(!0),children:[e.jsx(C,{size:16})," Add User"]})]}),e.jsx("div",{className:"table-container",children:j?e.jsx("p",{children:"Loading users..."}):e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:s.username}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.role==="admin"?"badge-primary":"badge-secondary"}`,children:s.role})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.status==="active"?"badge-success":"badge-danger"}`,style:{backgroundColor:s.status==="active"?"#dcfce7":"#fee2e2",color:s.status==="active"?"#166534":"#991b1b"},children:s.status})}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx("button",{className:"btn btn-secondary p-2",onClick:()=>f(s),title:s.status==="active"?"Disable Account":"Enable Account",children:s.status==="active"?e.jsx(m,{status:"active"}):e.jsx(m,{status:"disabled"})}),e.jsx("button",{className:"btn btn-danger p-2",onClick:()=>g(s.id),title:"Delete User",children:e.jsx(N,{size:16})})]})})]},s.id))})]})}),e.jsx(w,{isOpen:y,onClose:()=>l(!1),title:"Create New User",children:e.jsxs("form",{onSubmit:b,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Username / Email"}),e.jsx("input",{className:"input",required:!0,value:r.username,onChange:s=>i({...r,username:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Password"}),e.jsx("input",{className:"input",type:"password",required:!0,value:r.password,onChange:s=>i({...r,password:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Role"}),e.jsxs("select",{className:"input",value:r.role,onChange:s=>i({...r,role:s.target.value}),children:[e.jsx("option",{value:"user",children:"Standard User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"1rem"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Create User"})]})]})})]})},m=({status:h})=>h==="active"?e.jsx(A,{size:16,color:"#ef4444"}):e.jsx(U,{size:16,color:"#10b981"});export{P as default};
