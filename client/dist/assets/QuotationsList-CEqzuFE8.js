import{c as P,A as i,j as t,F as h}from"./index-Dp9SiYe_.js";import{b as a,L as o}from"./vendor-hBbQJCfh.js";import{a as r}from"./authFetch-CQWmCeCA.js";import{u as A,P as C}from"./PaginationControls-DK-cWpwm.js";import{C as E}from"./copy-DE5Co0sB.js";import{T as k}from"./trash-2-DHbAu9So.js";const z=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],D=P("eye",z),I=()=>{const[u,x]=a.useState([]),[j,c]=a.useState(!1),{currentPage:m,totalPages:p,pageSize:f,totalItems:y,currentItems:l,goToPage:g,changePageSize:w}=A(u);a.useEffect(()=>{d()},[]);const d=async()=>{try{c(!0);const e=await r(`${i}/api/quotations`);if(!e.ok)throw new Error("Failed to fetch quotes");const s=await e.json();x(Array.isArray(s)?s:[])}catch(e){console.error(e)}finally{c(!1)}},b=async e=>{if(window.confirm("Are you sure you want to delete this quote?"))try{(await r(`${i}/api/quotations/${e}`,{method:"DELETE"})).ok&&d()}catch(s){console.error(s)}},N=async e=>{if(window.confirm("Duplicate this quotation?"))try{const s=await r(`${i}/api/quotations/duplicate/${e}`,{method:"POST"});if(s.ok){const n=await s.json();window.location.href=`/quotations/${n.id}/edit`}else{const n=await s.json();console.error("Duplicate failed:",n),alert("Failed to duplicate: "+(n.error||s.statusText))}}catch(s){console.error(s),alert("Network error during duplication")}};return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex-between mb-6",children:[t.jsx("h2",{children:"Quotations"}),t.jsxs(o,{to:"/quotations/new",className:"btn btn-primary",children:[t.jsx(h,{size:16})," New Quote"]})]}),t.jsx("div",{className:"table-container",children:j?t.jsx("p",{children:"Loading quotations..."}):t.jsxs(t.Fragment,{children:[t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Date"}),t.jsx("th",{children:"Client"}),t.jsx("th",{children:"Items"}),t.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),t.jsxs("tbody",{children:[l.map(e=>t.jsxs("tr",{children:[t.jsx("td",{children:e.date}),t.jsx("td",{style:{fontWeight:500},children:e.client_name}),t.jsxs("td",{children:[e.item_count," Items"]}),t.jsx("td",{style:{textAlign:"right"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[t.jsx(o,{to:`/quotations/${e.id}`,className:"btn btn-secondary p-2",title:"View",children:t.jsx(D,{size:16})}),t.jsx(o,{to:`/quotations/${e.id}/edit`,className:"btn btn-secondary p-2",title:"Edit",children:t.jsx(h,{size:16})}),t.jsx("button",{className:"btn btn-secondary p-2",onClick:()=>N(e.id),title:"Duplicate",children:t.jsx(E,{size:16})}),t.jsx("button",{className:"btn btn-danger p-2",onClick:()=>b(e.id),title:"Delete",children:t.jsx(k,{size:16})})]})})]},e.id)),l.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:"4",style:{textAlign:"center",padding:"2rem"},children:"No quotations found. Create your first quote!"})})]})]}),t.jsx(C,{currentPage:m,totalPages:p,pageSize:f,totalItems:y,onPageChange:g,onPageSizeChange:w})]})})]})};export{I as default};
